<!DOCTYPE html>
<html>

<head>
<title>Clinician View</title>
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
	
		<meta charset="utf-8">
		<script type="text/javascript" src="src/d3.v5.min.js"></script>
		<script type="text/javascript" src="src/d3-dsv.min.js"></script>
		<script type="text/javascript" src="src/d3-fetch.min.js"></script>
		<script type="text/javascript" src="src/d3-scale-chromatic.v1.min.js"></script>
		<script type="text/javascript" src="src/d3-tip.min.js"></script>
		<script type="text/javascript" src="src/topojson.v2.min.js"></script>

  <style type="text/css">


	</style>

</head>

<body>

  <div class="grid-container">

    <header class="header">
      <div>
        Select a patient to review
      </div>
    </header>

    <main class="main">

	    	<script type="text/javascript">
			d3.csv("src/patient_data.csv", function(csvdata) {
                              return {csvdata["Patient ID"],
                                      csvdata["First name"] + " " +csvdata["Last name"],
				      //csvdata["First name"],
				      csvdata["Birthdate"],
				      csvdata["Gender"],
				      csvdata["Race"],
				      csvdata["Patient_Date"],
				      csvdata["Doctor_Date"]
				      ];   
			   }).then(function(data) {
				
				console.log(data);
				var n = data.length;
				var pt_reviewed = [];
				var pt_pending = [];
				
				for (var i=0;i<n;i++) {
					if (data[i][7].length>1)
						pt_reviewed.push(data[i]);
					else
						pt_pending.push(data[i]);
				}
				
				function str2date(str) {
					//var strDate = str.split(" ");
					var strDatepart = str.split("/");
					var dtDate = new Date(strDatepart[0],strDatepart[1]-1,strDatepart[2]);
					return dtDate;
				}
				
				pt_reviewed.sort( function(a,b) {return str2date(a[6]) -  str2date(b[6])} );
				pt_pending.sort( function(a,b) {return str2date(a[5]) -  str2date(b[5])} );
				console.log(pt_pending);
				
				pt_pending = pt_pending.sort( function(a,b) {return str2date(a[5]) -  str2date(b[5])} );
				console.log(pt_pending);
				
				
				
				document.write("<form>");
				document.write("These patients haven't been reviewed or given a recommendation <br>");
				for (var i=0;i<pt_pending.length;i++){
					pt = pt_pending[i];
					document.write("<input type='radio' name='patient' value='" +  pt[0]+ "'>" + "NameX: " + pt[1] + ", DOB: " + pt[3] + ", submitted on " + pt[6] + ", Pending for review <br>");
				}
				
				document.write("These patients haven been reviewed, select if you want to review your recommendation <br>");
				for (var i=0;i<pt_reviewed.length;i++){
					pt = pt_reviewed[i];
					document.write("<input type='radio' name='patient' value='" +  pt[0]+ "'>" + "Name: " + pt[1] + ", DOB: " + pt[3] +", submitted on " + pt[6] + ", reviewed on " + pt[7] + "<br>");
				}
				
				document.write("</form>")
				
			
				
				
				
			}); // end of then
			
			/*	    
	    	var a=new Date().getFullYear()
	for(i=1900;i<a+1;i++)
 	document.write("<option>"+i+"</option>")
	<form>
	  Diabetes (Please choose type)<br>
          <input type="radio" name="diabetes" value="MC1">Type 1 diabetes without complication<br>
          <input type="radio" name="diabetes" value="MC2">Type 1 diabetes with complication<br>
	  <input type="radio" name="diabetes" value="MC3">Type 2 diabetes without complication<br>
	  <input type="radio" name="diabetes" value="MC4">Type 2 diabetes with complication<br>
        </form>

*/
				

	</script>



    </main>


  </div>

</body>

</html>
